<div class="container mt-4">
  <div class="row">

    <!-- ▼ 左サイド：カテゴリ -->
    <aside class="col-12 col-md-3 mb-4">
      <h5 data-bs-toggle="collapse" data-bs-target="#communityCategoryList" style="cursor: pointer;">
        コミュニティカテゴリ ▼
      </h5>

      <ul id="communityCategoryList" class="list-group collapse show">
        <% @categories.each do |category| %>
          <li class="list-group-item">
            <%= link_to category.name, category_path(category) %>
          </li>
        <% end %>
      </ul>
    </aside>


    <!-- ▼ 右側：コミュニティ一覧 -->
    <div class="col-12 col-md-9">
      <% @communities.each do |community| %>
        <div class="card p-3 mb-3 d-flex flex-row justify-content-between align-items-start">

          <!-- コミュニティ情報 -->
          <div class="flex-grow-1 pe-3">
            <h4>
              <%= link_to community.name, community_path(community), class: "text-info" %>
            </h4>

            <p><%= approval_badge(community) %></p>

            <p>
              <strong>カテゴリ：</strong>
              <%= community.category&.name || "未設定" %>
            </p>

            <p>
              作成者：
              <%= link_to community.owner.name, user_path(community.owner) %>
            </p>

            <p>
              メンバー：<%= community.members.count %>人　
              トピック：<%= community.topics.count %>件
            </p>

            <p><%= truncate(community.description, length: 80) %></p>
          </div>

          <!-- コミュニティ画像（あれば） -->
          <% if community.image.attached? %>
            <div>
              <%= image_tag community.image, size: "230x230", class: "rounded", style: "object-fit: cover;" %>
            </div>
          <% end %>

          <!-- ページネーション -->
          <div class="mt-4">
            <%= paginate @communities %>
          </div>

        </div>
      <% end %>
    </div>

  </div>
</div>
