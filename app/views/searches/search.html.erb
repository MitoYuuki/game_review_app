<div class="container mt-4">

  <h3 class="mb-4 text-center">
    検索結果
    <% if @model == "user" %>
      （ユーザー）
    <% elsif @model == "post" %>
      （投稿）
    <% else %>
      （コミュニティ）
    <% end %>
  </h3>

  <% if @results.present? %>
    <div class="row justify-content-center">
      <div class="col-12 col-md-8">

        <% @results.each do |result| %>
          <div class="card mb-3 shadow-sm">
            <div class="card-body d-flex justify-content-between align-items-center">

              <div>
                <% if @model == "user" %>
                  <!-- ユーザー検索結果 -->
                  <div class="d-flex align-items-center">
                    <div class="me-3">
                      <% if result.profile_image.attached? %>
                        <%= image_tag result.profile_image,
                              size: "60x60",
                              class: "rounded-circle object-fit-cover" %>
                      <% else %>
                        <%= image_tag "default-image.png",
                              size: "60x60",
                              class: "rounded-circle" %>
                      <% end %>
                    </div>

                    <div>
                      <h5 class="mb-1 fw-bold"><%= result.name %></h5>
                    </div>
                  </div>

                <% elsif @model == "post" %>
                  <!-- 投稿検索結果 -->
                  <h5 class="card-title text-truncate fw-bold"><%= result.title %></h5>
                  <p class="card-text text-white mb-0">
                    <%= truncate(result.body, length: 80) %>
                  </p>

                <% elsif @model == "community" %>
                  <!-- コミュニティ検索結果 -->
                  <h5 class="fw-bold"><%= result.name %></h5>
                  <p class="text-white mb-0">
                    メンバー：<%= result.members.count rescue 0 %>人
                  </p>
                <% end %>
              </div>

              <!-- 右側の「詳細を見る」ボタン -->
              <div>
                <% path =
                  case @model
                  when "user" then user_path(result)
                  when "post" then post_path(result)
                  when "community" then community_path(result)
                  end %>

                <%= link_to "詳細を見る", path,
                      class: "btn btn-sm btn-primary" %>
              </div>

            </div>
          </div>
        <% end %>

      </div>
    </div>

  <% else %>
    <div class="alert alert-warning text-center">
      検索結果が見つかりませんでした
    </div>
  <% end %>

</div>
